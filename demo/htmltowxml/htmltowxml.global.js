!function(){function t(t){for(var e={},n=t.split(","),i=0;i<n.length;i++)e[n[i]]=!0;return e}function e(t){return t.replace(/<!DOCTYPE html>(.+?)<body>/i,"").replace(/<script (.+?)<\/script>.*/i,"").replace(/<\/body>/i,"").replace(/<\/html>/i,"")}function n(t){function e(t){if(t.child){i+='<view class="'+t.attr.class+'">';for(var n=0,s=t.child.length;n<s;n++)"element"==t.node&&e(t.child[n]);i+="</view>"}else"element"==t.node&&(i+="img"==t.tag?'<image class="'+t.attr.class+'" src="'+t.attr.src+'"></image>':'<view class="'+t.attr.class+'"></view>'),"text"==t.node&&(i+="<text>"+t.text+"</text>");return i}void 0===t&&(t="");var n="",i="";if(!t)return console.log("please input html content!!!"),0;for(var s=d(t).child,r=0,a=s.length;r<a;r++)n=e(s[r]);return n}function i(t){var e="";return 0==t.length?"":(e=t.replace(/&/g,"&gt;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/ /g,"&nbsp;"),e=e.replace(/\'/g,"&#39;"),e=e.replace(/\"/g,"&quot;"),e=e.replace(/\n/g,"<br>"))}var s=/^<([-A-Za-z0-9_]+)((?:\s+[a-zA-Z_:][-a-zA-Z0-9_:.]*(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,r=/^<\/([-A-Za-z0-9_]+)[^>]*>/,a=t("area,base,basefont,br,col,frame,hr,img,input,link,meta,param,embed,command,keygen,source,track,wbr"),o=t("a,address,article,applet,aside,audio,blockquote,button,canvas,center,dd,del,dir,div,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,output,p,pre,section,script,table,tbody,td,tfoot,th,thead,tr,ul,video"),h=t("abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),l=t("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),c=t("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),u=t("script,style"),p=function(t,e){function n(t,n,s,r){if(n=n.toLowerCase(),o[n])for(;f.last()&&h[f.last()];)i("",f.last());if(l[n]&&f.last()==n&&i("",n),r=a[n]||!!r,r||f.push(n),e.start){var u=[];s.replace(/([a-zA-Z_:][-a-zA-Z0-9_:.]*)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,function(t,e){var n=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:c[e]?e:"";u.push({name:e,value:n,escaped:n.replace(/(^|[^\\])"/g,'$1\\"')})}),e.start&&e.start(n,u,r)}}function i(t,n){if(n)for(var i=f.length-1;i>=0&&f[i]!=n;i--);else var i=0;if(i>=0){for(var s=f.length-1;s>=i;s--)e.end&&e.end(f[s]);f.length=i}}var p,_,d,f=[],g=t;for(f.last=function(){return this[this.length-1]};t;){if(_=!0,f.last()&&u[f.last()])t=t.replace(new RegExp("([\\s\\S]*?)</"+f.last()+"[^>]*>"),function(t,n){return n=n.replace(/<!--([\s\S]*?)-->|<!\[CDATA\[([\s\S]*?)]]>/g,"$1$2"),e.chars&&e.chars(n),""}),i("",f.last());else if(0==t.indexOf("<!--")?(p=t.indexOf("-->"),p>=0&&(e.comment&&e.comment(t.substring(4,p)),t=t.substring(p+3),_=!1)):0==t.indexOf("</")?(d=t.match(r),d&&(t=t.substring(d[0].length),d[0].replace(r,i),_=!1)):0==t.indexOf("<")&&(d=t.match(s),d&&(t=t.substring(d[0].length),d[0].replace(s,n),_=!1)),_){p=t.indexOf("<");var m=p<0?t:t.substring(0,p);t=p<0?"":t.substring(p),e.chars&&e.chars(m)}if(t==g)throw"Parse Error: "+t;g=t}i()},_=function(){},d=function(t){t=(t||"").replace(/\s+/g," "),t=e(t);var n=[],i={node:"root",child:[]};return p(t,{start:function(t,e,s){_(t,e,s);var r={node:"element",tag:t};if(0!==e.length&&(r.attr=e.reduce(function(t,e){var n=e.name,i=e.value;return i=i.replace(/(&nbsp;)/g," "),i=i.replace(/(&gt;)/g,">"),i=i.replace(/(&lt;)/g,"<"),i=i.replace(/(&amp;)/g,"&"),i=i.replace(/(&quot;)/g,'"'),i=(i.split(";")||[]).map(function(t){if(t.indexOf("px")!=-1){var e=t.split(":")[1],n=t.split(":")[0];if(e.split(/\s/g).length>1)return e.map(function(e){var i=Number.parseInt(e);return isNaN(i)?t:(i*=2,n+": "+i+"rpx;")});var i=Number.parseInt(e);return isNaN(i)?t:(i*=2,n+": "+i+"rpx;")}return t}).join(" "),t[n]?Array.isArray(t[n])?t[n].push(i):t[n]=[t[n],i]:t[n]=i,t},{})),["h1","h2","h3","h4","h5","h6","a","abbr","address","applet","acronym","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","command","datalist","dd","del","details","dfn","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","head","header","hgroup","hr","html","i","iframe","img","input","ins","keygen","kbd","label","legend","li","link","map","mark","menu","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rp","ruby","s","samp","script","select","small","source","span","strike","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr","rt","section"].includes(t)&&(r.attr&&r.attr.class?r.attr.class=r.attr.class+" "+t:(r.attr=r.attr||{},r.attr.class=t)),s){var a=n[0]||i;void 0===a.child&&(a.child=[]),a.child.push(r)}else n.unshift(r)},end:function(t){_(t);var e=n.shift();if(e.tag!==t&&console.error("invalid state: mismatch end tag"),0===n.length)i.child.push(e);else{var s=n[0];void 0===s.child&&(s.child=[]),s.child.push(e)}},chars:function(t){if(_(t)," "!=t){var e={node:"text",text:t};if(0===n.length)i.child.push(e);else{var s=n[0];void 0===s.child&&(s.child=[]),s.child.push(e)}}},comment:function(t){_(t);var e={node:"comment",text:t},i=n[0];void 0===i.child&&(i.child=[]),i.child.push(e)}}),i},f=function(t,e){function n(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(t,e){for(var n=0;n<e.length;n++)if(t===e[n])return!0;return!1}},this.get_content=function(){for(var t=this,e="",n=[],i=!1;"<"!==this.input.charAt(this.pos);){if(t.pos>=t.input.length)return n.length?n.join(""):["","TK_EOF"];if(e=t.input.charAt(t.pos),t.pos++,t.line_char_count++,t.Utils.in_array(e,t.Utils.whitespace))n.length&&(i=!0),t.line_char_count--;else{if(i){if(t.line_char_count>=t.max_char){n.push("\n");for(var s=0;s<this.indent_level;s++)n.push(t.indent_string);t.line_char_count=0}else n.push(" "),t.line_char_count++;i=!1}n.push(e)}}return n.length?n.join(""):""},this.get_contents_to=function(t){if(this.pos==this.input.length)return["","TK_EOF"];var e="",n=new RegExp("</"+t+"\\s*>","igm");n.lastIndex=this.pos;var i=n.exec(this.input),s=i?i.index:this.input.length;return this.pos<s&&(e=this.input.substring(this.pos,s),this.pos=s),e},this.record_tag=function(t){this.tags[t+"count"]?(this.tags[t+"count"]++,this.tags[t+this.tags[t+"count"]]=this.indent_level):(this.tags[t+"count"]=1,this.tags[t+this.tags[t+"count"]]=this.indent_level),this.tags[t+this.tags[t+"count"]+"parent"]=this.tags.parent,this.tags.parent=t+this.tags[t+"count"]},this.retrieve_tag=function(t){var e=this;if(this.tags[t+"count"]){for(var n=this.tags.parent;n&&t+e.tags[t+"count"]!==n;)n=e.tags[n+"parent"];n&&(this.indent_level=this.tags[t+this.tags[t+"count"]],this.tags.parent=this.tags[n+"parent"]),delete this.tags[t+this.tags[t+"count"]+"parent"],delete this.tags[t+this.tags[t+"count"]],1==this.tags[t+"count"]?delete this.tags[t+"count"]:this.tags[t+"count"]--}},this.get_tag=function(){var t,e,n=this,i="",s=[],r=!1;do{if(n.pos>=n.input.length)return s.length?s.join(""):["","TK_EOF"];i=n.input.charAt(n.pos),n.pos++,n.line_char_count++,n.Utils.in_array(i,n.Utils.whitespace)?(r=!0,n.line_char_count--):("'"!==i&&'"'!==i||s[1]&&"!"===s[1]||(i+=n.get_unformatted(i),r=!0),"="===i&&(r=!1),s.length&&"="!==s[s.length-1]&&">"!==i&&r&&(n.line_char_count>=n.max_char?(n.print_newline(!1,s),n.line_char_count=0):(s.push(" "),n.line_char_count++),r=!1),"<"===i&&(t=n.pos-1),s.push(i))}while(">"!==i);var a,o=s.join("");a=o.indexOf(" ")!=-1?o.indexOf(" "):o.indexOf(">");var l=o.substring(1,a).toLowerCase();if("/"===o.charAt(o.length-2)||this.Utils.in_array(l,this.Utils.single_token))this.tag_type="SINGLE";else if("script"===l)this.record_tag(l),this.tag_type="SCRIPT";else if("style"===l)this.record_tag(l),this.tag_type="STYLE";else if(this.Utils.in_array(l,h)){var c=this.get_unformatted("</"+l+">",o);s.push(c),t>0&&this.Utils.in_array(this.input.charAt(t-1),this.Utils.whitespace)&&s.splice(0,0,this.input.charAt(t-1)),e=this.pos-1,this.Utils.in_array(this.input.charAt(e+1),this.Utils.whitespace)&&s.push(this.input.charAt(e+1)),this.tag_type="SINGLE"}else if("!"===l.charAt(0))if(l.indexOf("[if")!=-1){if(o.indexOf("!IE")!=-1){var c=this.get_unformatted("-->",o);s.push(c)}this.tag_type="START"}else if(l.indexOf("[endif")!=-1)this.tag_type="END",this.unindent();else if(l.indexOf("[cdata[")!=-1){var c=this.get_unformatted("]]>",o);s.push(c),this.tag_type="SINGLE"}else{var c=this.get_unformatted("-->",o);s.push(c),this.tag_type="SINGLE"}else"/"===l.charAt(0)?(this.retrieve_tag(l.substring(1)),this.tag_type="END"):(this.record_tag(l),this.tag_type="START"),this.Utils.in_array(l,this.Utils.extra_liners)&&this.print_newline(!0,this.output);return s.join("")},this.get_unformatted=function(t,e){var n=this;if(e&&e.toLowerCase().indexOf(t)!=-1)return"";var i="",s="",r=!0;do{if(n.pos>=n.input.length)return s;if(i=n.input.charAt(n.pos),n.pos++,n.Utils.in_array(i,n.Utils.whitespace)){if(!r){n.line_char_count--;continue}if("\n"===i||"\r"===i){s+="\n",n.line_char_count=0;continue}}s+=i,n.line_char_count++,r=!0}while(s.toLowerCase().indexOf(t)==-1);return s},this.get_token=function(){var t;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var e=this.last_token.substr(7);return t=this.get_contents_to(e),"string"!=typeof t?t:[t,"TK_"+e]}if("CONTENT"===this.current_mode)return t=this.get_content(),"string"!=typeof t?t:[t,"TK_CONTENT"];if("TAG"===this.current_mode){if(t=this.get_tag(),"string"!=typeof t)return t;return[t,"TK_TAG_"+this.tag_type]}},this.get_full_indent=function(t){return t=this.indent_level+t||0,t<1?"":Array(t+1).join(this.indent_string)},this.printer=function(t,e,n,i,s){var r=this;this.input=t||"",this.output=[],this.indent_character=e,this.indent_string="",this.indent_size=n,this.brace_style=s,this.indent_level=0,this.max_char=i,this.line_char_count=0;for(var a=0;a<this.indent_size;a++)r.indent_string+=r.indent_character;this.print_newline=function(t,e){var n=this;if(this.line_char_count=0,e&&e.length){if(!t)for(;this.Utils.in_array(e[e.length-1],this.Utils.whitespace);)e.pop();e.push("\n");for(var i=0;i<this.indent_level;i++)e.push(n.indent_string)}},this.print_token=function(t){this.output.push(t)},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}var i,s,r,a,o,h;for(e=e||{},s=e.indent_size||4,r=e.indent_char||" ",o=e.brace_style||"collapse",a=0==e.max_char?1/0:e.max_char||70,h=e.unformatted||["a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],i=new n,i.printer(t,r,s,a,o);;){var l=i.get_token();if(i.token_text=l[0],i.token_type=l[1],"TK_EOF"===i.token_type)break;switch(i.token_type){case"TK_TAG_START":i.print_newline(!1,i.output),i.print_token(i.token_text),i.indent(),i.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":i.print_newline(!1,i.output),i.print_token(i.token_text),i.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===i.last_token&&""===i.last_text){var c=i.token_text.match(/\w+/)[0],u=i.output[i.output.length-1].match(/<\s*(\w+)/);null!==u&&u[1]===c||i.print_newline(!0,i.output)}i.print_token(i.token_text),i.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var p=i.token_text.match(/^\s*<([a-z]+)/i);p&&i.Utils.in_array(p[1],h)||i.print_newline(!1,i.output),i.print_token(i.token_text),i.current_mode="CONTENT";break;case"TK_CONTENT":""!==i.token_text&&i.print_token(i.token_text),i.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==i.token_text){i.output.push("\n");var _=i.token_text;if("TK_SCRIPT"==i.token_type)var d="function"==typeof js_beautify&&js_beautify;else if("TK_STYLE"==i.token_type)var d="function"==typeof css_beautify&&css_beautify;if("keep"==e.indent_scripts)var f=0;else if("separate"==e.indent_scripts)var f=-i.indent_level;else var f=1;var g=i.get_full_indent(f);if(d)_=d(_.replace(/^\s*/,g),e);else{var m=_.match(/^\s*/)[0],v=m.match(/[^\n\r]*$/)[0].split(i.indent_string).length-1,b=i.get_full_indent(f-v);_=_.replace(/^\s*/,g).replace(/\r\n|\r|\n/g,"\n"+b).replace(/\s*$/,"")}_&&(i.print_token(_),i.print_newline(!0,i.output))}i.current_mode="TAG"}i.last_token=i.token_type,i.last_text=i.token_text}return i.output.join("")},g=document.getElementById("html"),m=document.getElementById("wxml");document.getElementById("cover").addEventListener("click",function(){var t=n(g.value),e=f(t,{indent_size:2});t&&(m.innerHTML=i(e))},!1)}();
//# sourceMappingURL=htmltowxml.global.js.map
